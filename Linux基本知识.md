## Ubuntu文件系统结构

##### /bin 

存放二进制可执行文件这些命令在单用户模式下也能够使用可以被root和一般的账号使用

##### /boot 

Ubuntu内核和启动文件，比如vmlinuz-xxx。qurb引导装载程序。

##### /dev 

设备驱动文件

##### /etc 

存放一些系统配置文件，比如用户账号和密码文件，各种服务的起始地址。

##### /home 

系统默认的用户主文件夹，一般创建用户账户的时候，默认的用户主文件夹都会放到此目录下

##### /lib 

存放库文件

##### /media

此目录下放置可插拔设备，比如SD卡，或者U盘就是挂载到这个目录中。

##### /mnt 

用户可使用的挂载点，如果要挂载一些额外的设备，那么就可以挂载到此处。

##### /opt

可选的文件和程序存放目录，给第三方软件放置的目录。

##### /root

root用户目录，也就是系统管理员目录。

##### /sbin

和/bin类似也是存放一些二进制可执行文件。sbin下面的一般是系统开机过程中所需要的命令

##### /srv

服务相关目录。比如网络服务。

##### /sys 

记录内核信息，虚拟文件系统。

##### /tmp

临时目录

##### /var

存放一些变化的文件，比如日志文件

##### /usr

usr不是user的缩写，而是UNIXSoftwareResource的缩写，存放于系统用户有关的文件，会占用很大的空间

##### /proc

虚拟文件系统，数据放置到内存中，存放系统运行信息

## Ubuntu磁盘管理

### 磁盘文件

/dev/sd*文件，此类文件是磁盘设备文件，并不能直接访问磁盘，必须要将磁盘挂载到某一个目录下才可以访问。

### 磁盘和目录的容量查询命令

df：列出文件系统的整体磁盘使用量。主要查看一个文件系统的使用量
du：评估文件系统的磁盘使用量，主要查看单个文件的大小。

## 磁盘挂载与卸载，分区和格式化

### 磁盘的挂载和卸载

mount：挂载磁盘
mount [dev目录下要挂载的设备文件] [挂载的路径，要先创建]
mount /dev/sdb1 /media/rodney/up

umount：卸载磁盘
sudo umount [挂载的路径]

### 磁盘分区

fdisk命令
如果分区大小为1GB,1GB = 1x1024x1024x1024=1073741824B=1073741824/512扇区 = 2097152扇区，+2048(从2048开始) = 2099200扇区

fdisk -l /dev/sd*可以查看分区信息

### 磁盘格式化

磁盘分区创建号之后就可以进行格式化，使用命令mkfs，如：

mkfs -t vfat /dev/sdx

## Ubuntu下压缩与解压缩

### Linux下常用的压缩格式

.tar   .tar.bz2	.tar.gz

### gzip压缩工具

gzip工具负责压缩和解压缩.gz格式的压缩包

gzip xxx  			//压缩

gzip -d xxx.gz	//解压缩



gzip对文件夹进行压缩:

gzip -r xxx		//对文件夹进行压缩   （将文件夹下的所有文件分别压缩，没有打包）

gzip -rd xxx.gz	//对文件夹进行解压缩

gzip虽然可以对文件夹进行压缩，但是不能提供打包的服务，只是对文件夹中的所有文件进行了单独的压缩

### bzip2压缩工具

和gzip很相似，只是bzip2工具负责的是.bz2文件的压缩
-z是压缩		-d是解压缩  （没有对文件夹的递归压缩）

### tar打包工具

-f ：使用归档文件或ARCHIVE设备
-c：创建新归档，创建压缩文件
-x：从归档中解出文件，解压缩
-j：使用bzip2压缩格式
-z：使用gzip压缩格式
-v：打印出命令执行过程

#### tar工具提供打包服务，就是将多个文件打包（只是打包，没有压缩）比如

tar -vcf test.tar test			//将test打包成test.tar
tar -vxf test.tar					//解包

#### 对.tar.bz2进行压缩和解压缩

tar -vcjf xxx.tar.bz2 xxx			//压缩
tar -vxjf xxx.tar.bz2					//解压缩

#### 对.tar.gz进行压缩和解压缩

tar -vczf xxx.tar.gz xxx			//压缩
tar -vxzf xxx.tar.gz					//解压缩

上面的tar命令只是提供了打包和解包的功能，tar在提供打包和解包的同时使用gzip/bzip2进行压缩，实现类似winRAR的功能

### RAR格式的压缩和解压缩

需要先安装rar: sudo apt install rar

rar -a xxx.rar xxx		//压缩
rar -x xxx.rar				//解压缩

## Linux用户与用户组

#### Linux用户

Linux是一个多用户的操作系统，，不同的用户拥有不同的权限。可以查看和操作不同的文件。Ubuntu有三种用户：

1. 初次创建的用户
2. root用户
3. 普通用户

初次创建的用户权限比普通用户多，但是没有root用户多，初次创建的用户可以创建普通用户。
Linux用户记录在/etc/passwd这个文件夹中
Linux用户密码记录在/etc/shadow这个文件夹中
每个用户都有一个ID，也叫UID

#### 用户组

为了方便管理，将用户进行分组。这样就可以设置非本组人员不能访问某些文件。每个用户可以属于多个不同的组。
用户和用户组的存在就是为了控制文件的访问权限的。
每个用户组都有一个ID，叫做GID。
用户组信息存储在/etc/group文件中。

#### 创建用户和用户组

##### 图形化界面

安装：sudo apt install gnome-system-tools

##### 命令创建用户和用户组

添加用户：adduser [用户名]
用户查询：finger [用户名]
修改用户密码：passwd [用户名]
删除用户:deluser [用户名]

添加用户组：addgroup [用户组名]
显示组内成员：groups [用户组名]
删除用户组：delgroup [用户组名]

## Ubuntu/Linux文件权限

Ubuntu 下我们会常跟用户权限打交道，权限就是用户对于系统资源的使用限制情况，root 用户拥有最大的权限，可以为所欲为，装系统的时候创建的用户拥有root 用户的部分权限，其它普通用户的权限最低。对于我们做嵌入式开发的人一般不关注用户的权限问题，因为嵌入式基本是单用户，做嵌入式开发重点关注的是文件的权限问题。

### ls -l输出的含义

对于一个文件通常有三种权限：读(r)、写(w)和执行(x)，使用命令“**ls -l**”可以查看某个目 录下所有文件的权限信息。显示如下：
**-rw-rw-r-- 1 rodney rodney 4 Aug 29 00:43 a.c**
前面共有10位，第一位表示文件类型：
\- 普通文件，一些应用程序创建的，比如文档、图片、音乐等等。 
d 目录文件。 
c 字符设备文件，Linux 驱动里面的字符设备驱动，比如串口设备，音频设备等。 
b 块设备文件，存储设备驱动，比如硬盘，U 盘等。 
l 符号连接文件，相当于 Windwos 下的快捷方式。 
s 套接字文件。 
p 管道文件，主要指 FIFO 文件。

剩下的 9 位以 3 位为一组，分别表示**文件拥有者**的权限，**文件拥有者所在用户组** 的权限以及**其它用户权限**。

所以上面输出的信息表示：a.c所属用户拥有读写权限无可执行权限，组内其他用户拥有读写权限无可执行权限，组外其他用户仅有可读权限。
所属用户：rodney
所属用户组：rodney

### 权限的其他表示方式：

除了用 r、w 和 x 表示以外， 我们也可以使用二进制数表示，三种权限就可以使用 3 位二进制数来表示，一种权限对应一个 二进制位，如果该位为 1 就表示具备此权限，如果该位为 0 就表示没不具备此权限。

| 字母 | 二进制 | 八进制 |
| :--: | :----: | :----: |
|  r   |  100   |   4    |
|  w   |  010   |   2    |
|  x   |  001   |   1    |

如果做过单片机开发的话，就会发现和单片机里面的寄存器位一样，将三种权限 r、w 和 x 进行不同的组合，即可得到不同的二进制数和八进制数，3 位权限可以组出 8 种不同的权限组 合

| 权限 | 二进制 | 八进制 |
| :--: | :----: | :----: |
| ---  |  000   |   0    |
| --x  |  001   |   1    |
| -w-  |  010   |   2    |
| -wx  |  011   |   3    |
| r--  |  100   |   4    |
| r-x  |  101   |   5    |
| rw-  |  110   |   6    |
| rwx  |  111   |   7    |

前面的文件 a.c 其权限为“rw-rw-r--”，因此其十进制表示就是：664。
另外我们也开始使用 a、u、g 和 o 表示文件的归属关系，用=、+和-表示文件权限的变化

| 字母 |    意义    |
| :--: | :--------: |
|  r   |  可读权限  |
|  w   |  可写全写  |
|  x   | 可执行权限 |
|  a   |  所以用户  |
|  u   |  所属用户  |
|  g   |   归属组   |
|  o   |  其他用户  |
|  =   |  具备权限  |
|  +   |  添加权限  |
|  -   |  去除权限  |

对于文件 a.c，我们想要修改其归属用户(rodney)对其拥有可执行权限，那么就可以 使用：u+x。如果希望设置归属用户及其所在的用户组都对其拥有可执行权限就可以使用：gu+x。

### 文件权限修改

##### 修改文件权限命令：chmod命令

chmod [权限命令符] [文件路径]
权限命令符：
xxx   ——八进制数字，直接设置所有属性
u+x  ——所属关系(augo)+权限变化符号(=+-)+权限(rwx)

##### 修改文件所属用户：chown命令

chown [目标用户]   --修改所属用户（不改用户组）
chown [.用户组]		--修改所属用户组
chown [目标用户.用户组]  --一次修改所属用户和用户组

## Linux连接文件

Linux有两种连接文件:符号连接(软连接)和硬链接，符号链接类似Windows下的快捷方式。硬链接通过文件系统的inode连接来产生新文件名，而不是产生新文件。

inode:记录文件属性一个文件一个inode。inode相当于文件ID查找文件的时候要先找到inode，然后才能读出文件的内容。

#### ln命令

ln命令用于创建连接文件：

ln[选项] 源文件 目标文件
选项：-s  创建符号连接（软连接）
			-f 强制创建连接文件，如果目标存在，那么先删除目标文件，然后再建立连接文件

#### 硬链接

硬链接是多个文件都指向同一个inode，硬链接知识点:

1. 具有相同inode的多个文件**互为**硬链接文件，创建硬链接相当于文件实体多了入口
2. 对干硬链接文件，只有删除了源文件以及对应的所有硬连接文件，文件实体才会被删除
3. 根据硬链接文件的特点我们可以通过给文件创建硬连接的方式来防止文件误删除
4. 不论修改源文件还是硬连接文件，另一个文件的数据都会被改变。
5. 硬连接不能跨文件系统。
6. 硬连接不能连接到目录。

因为以上这些限制，硬链接其实不常用。

#### 符号连接（软连接）

符号连接类似Windows下的快捷方式，符号链接也叫做软连接，软连接要用的多。符号连接相当于创建了一个独立的文件这个文件会让数据读取指向它连接的哪个文件的文件名。软连接的特点:

1. 可以连接到目录。
2. 可以跨文件系统
3. 删除源文件以后，软连接文件也就”打不开了”。
4. 符号连接文件通过->来指示具体的连接文件。
5. 符号连接要使用**绝对路径**，否则连接会出现问题